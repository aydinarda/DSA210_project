# Sent Mails Analysis & Comparisons with LLM generated mails

## Description

SabancÄ± University CS210 Introduction to Data Science Course Fall 2024-2025 Term Project.  
This project will be an analysis of my own sent email interactions.

For the final presentation, a file will be shared [here](https://docs.google.com/presentation/d/1wiyq_E6wx1zO6KUc2wcIdjRx3ZfrCVFE2emdkgISrgc/edit?usp=sharing).

In this project, it is assumed that original data will be distinct from the GPT-generated data in characteristics, even after the necessary information is provided to GPT.

## Table of Contents

- [Motivation](#motivation)  
- [Tools](#tools)  
- [Data Source](#data-source)  
  - [Requested Data](#requested-data)  
  - [ChatGPT API](#chatgpt-api)  
- [Data Processing](#data-processing)  
- [Data Analysis](#data-analysis)  
  - [Subject Analysis](#header-analysis)  
  - [Time Analysis](#time-analysis)  
  - [Mail Body Analysis](#mail-body-analysis)  
  - [GPT-Generated Data Analysis](#gpt-generated-data-analysis)  
- [Findings & Visualizations](#findings-and-visualizations)  
  - [Distributions of Original Data](#distributions-of-original-data)  
  - [Distributions of GPT-Generated Data](#distributions-of-gpt-generated-data)  
  - [Comparative Analysis](#comparative-analysis)  
- [Limitations](#limitations)  
  - [Data Limitations](#data-limitations)  
  - [Privacy Considerations](#privacy-considerations)  
  - [Technical Challenges](#technical-challenges)  
- [Future Work](#future-work)

## Motivation

To kickstart my project for the CS210 course using my own data, I chose to analyze my sent emails to gain insights into their characteristics and compare them to emails generated by an AI model (ChatGPT).  
The motivation is to better understand how AI agents can mimic my email-writing behavior when provided with contextual data.

## Tools

- **Python Notebook:** Used for coding, anaylzing and visualizing.  
- **Pandas:** Used for data cleaning, filtering, and structuring.  
- **Matplotlib and Seaborn:** To have necessary visualizations.  
- **Numpy:** Used for mathematical operations.  
- **Scipy:** Used for statistical analysis.  
- **distfit:** Used for distribution fitting.  
- **transformers:** Simplifies the usage of pre-trained models from Hugging Face.
- **openai:** To interact with the OpenAI API.
-**FlagReranker** To compute some [formality score](#formality-score) .
  
## Data Source

### Requested Data

Requested data is in `.mbox` format, acquired via Google Takeout. The dataset includes the following:

- **Sent Mails**: Emails I sent, containing:
  - **From:** The sender's email address (two different addresses used).  
  - **To:** The recipient's email address.  
  - **Subject:** The email subject, e.g., "Inquiry about Master's Applications."  
  - **Body:** The main content of the email.  
  - **In-Reply-To:** Indicates **if** the email is a reply to a specific message.  
A parsed and organized version can be found in [here](example_mail_organized.txt) 

### ChatGPT API

The ChatGPT API is used to generate comparable email data based on the following:  
- Headers synthesized based on context.  
- Emails written for the given situation.  
- Suggested send times, derived from the analysis of original data patterns.  
- GPT 3.5 is used, since it is cheaper per token. 

## Data Processing

Data preprocessing is performed using [here]() and includes:  
- Cleaning (e.g., removing special characters, handling null values).  
- Structuring (e.g., separating headers, body text, and metadata).  
- Annotating sentiment and tone using NLP techniques.  

## Data Analysis

### Header Analysis

- Extract topics and themes from email headers.  
- Categorize headers based on recurring patterns and contexts.  

### Time Analysis

- Analyze email-sending patterns by time of day and day of the week.  
- Evaluate GPT-generated timestamps for consistency with original data.  

### Mail Body Analysis

- Study the tone, sentiment, and complexity of email bodies.  
- Measure average word length, sentence structure, and key phrases.

### Formality Score
- Using FlagReranker, mail's similarities to words "formal" and "informal" compared.
- For more information check [here](https://huggingface.co/BAAI/bge-reranker-v2-m3)

### GPT-Generated Data Analysis

- Compare GPT-generated email characteristics (headers, timestamps, body) with original data to evaluate alignment and deviations.  

## Findings & Visualizations

### Distributions of Original Data

- Visualizations of key characteristics in the original dataset (e.g., word count, time distribution).  
- - Example versions can be viewed [here](initial_distributions.png).

### Distributions of GPT-Generated Data

- Visualizations of the same characteristics in the GPT-generated data.  

### Comparative Analysis

- Overlay comparisons of distributions (e.g., original vs. generated).  
- Hypothesis testing to determine statistical significance of observed differences.  

## Limitations

### Data Limitations

- **Dataset Size:** Limited email data may restrict generalizability.  
- **Subjectivity:** Manual annotations may introduce bias, despite efforts to ensure objectivity.  

### Privacy Considerations

- Email content is anonymized, and only aggregate results and example outputs are shared.  

### Technical Challenges

- **Explainability:** Understanding the rationale behind GPT outputs is complex.  
- **Sentiment Analysis Accuracy:** Dependence on pre-trained models limits nuanced interpretations.  

## Future Work

- **Final Report Website:** A dedicated website will summarize findings, with interactive visualizations and insights.  
- **Sentiment and Context Analysis:** Deepen the analysis of sentiment and email context to refine AI-generated results.  
- **Scaling the Project:** Include emails from multiple individuals to create a broader dataset for analysis.
- **Comparing Versions:** Different versions of ChatGPT (3.5, 4, 4-o) can be compared. 
